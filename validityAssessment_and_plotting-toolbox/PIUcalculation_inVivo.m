%% Percentage Integral Uniformity - in vivo mouse 
% 
% The PIU can quantitatively assess the homogeneity of the corrected images
%
% This code calculates the PIU on the cortex and the basal ganglia/thalamus
% (left and right) as selected manually from the images
%
%
% If you use or modify this code, please cite:
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Ramos Delgado P, Kuehne A, Periquito J, et al. B1 Inhomogeneity 
% Correction of RARE MRI with Transceive SurFA_orderedce Radiofrequency Probes. 
% Magnetic Resonance in Medicine 2020; 00:1-20. 
% https://doi.org/10.1002/mrm.28307
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%
% INPUT:
%%%% img_vol          : volume RF coil image
%%%% img_ori          : original cryoprobe or Tx/Rx surface RF coil image
%%%% sensCorrected    : B1-corrected (sensitivity) image
%%%% MBCorrected      : B1-corrected (model-based) image
%%%% hybCorrected     : B1-corrected (hybrid) image
%
% OUTPUT:
%%%% PIU_all = [PIU_vol,PIU_ori,PIU_MBcorr,PIU_sens,PIU_hyb];
%%%% excel sheet with PIU values
%
%
% IMPORTANT: a PIU of 100% represents perfect image homogeneity
%
% April 2020
% Paula Ramos Delgado
% ramosdelgado.paula@gmail.com
%

%% Load data

load('O:\Users\pramosdelgado\test_data\cryoprobe_data\inVivoData_cryo.mat','img_ori', 'img_vol','params_crp');
load('O:\Users\pramosdelgado\results_folder\B1correction\sensCorrection_inVivo.mat','sensCorrected');
load('O:\Users\pramosdelgado\results_folder\B1correction\modelBasedCorrection_inVivo.mat','MBCorrected');
load('O:\Users\pramosdelgado\results_folder\B1correction\hybridCorrection_inVivo.mat','hybCorrected');


%% User-defined parameters

pathOUT = 'O:\Users\pramosdelgado\output_folder';


% Select ROI positions %%%%%%%%%%%%%%%%%%

% Volume RF coil
figure(), imagesc(img_vol, [0 5e7]), shg, colormap(gray(256))

cortex_vol = impoly(gca, [58.9650909271097 34.3793188613025;56.6012833853625 34.6887950084492;54.4085392170064 35.8576867559716;52.3979026513653 37.4241546266965;51.0128611001187 38.3754318385007;49.2400079145232 39.3267090503048;47.300949742778 40.753624868011;45.4726948951326 42.0378491039466;43.9355086467469 44.0615011791796;42.7006838115059 45.8299363057325;42.488999554036 47.200473528811;42.3478767157227 49.4110174370021;42.383157425301 51.6657722233571;42.4537188444577 53.168942080927;42.488999554036 54.3626357913502;43.3710172934939 55.6889621362649;43.4768594222288 56.8826558466881;44.2530350329518 58.0321386789475;44.5705614191566 59.3142541456983;44.8175263862048 60.8174240032683;45.6289827065061 61.5690089320533;46.8285268321689 61.6132198102171;48.2044745057232 61.5690089320533;49.4745800505426 61.4805871757256;50.5682820474704 61.4363762975618;51.7678261731331 61.4805871757256;52.8968088796393 61.4805871757256;53.6024230712056 61.4363762975618;54.1707558369608 61.2060849218;53.5059358923625 60.7780101764881;52.1762960031658 60.6828824553077;51.1236644242184 60.1596799888154;49.5724178868223 59.826732964684;48.4089829837752 59.2084027770113;46.5807281361298 58.5425087287484;45.8605065294816 57.6863592381247;45.5584212873495 56.7500232121966;44.9939299340964 55.6447512581011;44.5705614191566 54.4952684258417;44.4294385808434 53.2573638372547;44.4294385808434 51.5331395888656;44.394157871265 49.941547974968;44.394157871265 48.7920651427086;44.3588771616867 46.8025756253366;44.9233685149398 46.0952015747154;45.694301543332 44.9868084605394;47.1260924624501 43.3074745311862;48.6767550698113 41.7050590562528;49.968509984639 40.5688418042376;51.8383875922898 39.5519916064697;53.4965809424706 38.8004066776847;55.4017392596997 37.9161891144083;57.0599326098806 37.2972368201148;59.1062137654229 37.0761824292957;60.9408106634954 37.2088150637871;62.8106882711461 38.5351414087018;63.3751796243992 39.4635698501421;64.0455131063872 40.215154778927;64.7511272979535 40.5246309260738;66.1270749715079 40.215154778927;66.6915663247609 39.3751480938144;67.5030226450622 38.5793522868656;69.0906545760864 37.5625020890977;70.5724443783757 37.4740803327701;72.2306377285566 37.4298694546062;73.7124275308458 37.9161891144083;75.51174371934 38.1814543833912;77.8049898419305 39.0656719466677;79.4631831921114 39.728835119125;80.9449729944007 40.8341070732206;82.4620435062683 41.9835899054799;83.8027104702443 43.3983380067223;85.0728160150637 44.7688752298008;85.6020266587384 45.7857254275687;86.2723601407264 47.2446844069748;86.4134829790397 48.6594325082171;86.5193251077746 51.2236634417188;86.2017987215698 53.4784182280738;84.9740799366838 55.688677093336;83.7703349373645 56.902418908793;82.7685342203261 58.1335851088227;80.919055973486 59.0971064827589;78.9154545394092 59.9000409610392;77.4512842606608 60.9170913001941;76.5265451372408 61.5059099175996;76.2206173328057 62.1097982730139;76.6638306292046 62.6330007395062;78.298919776027 62.0995394700191;78.5458847430752 62.4974373734935;79.0750953867499 62.4974373734935;80.4510430603042 62.5416482516574;81.8622714434369 62.5858591298212;82.7090084733165 62.630070007985;83.8027104702443 62.2321721045106;84.2613596947624 61.6574306883809;84.7552896288588 60.5079478561215;85.3197809821119 59.5353085365174;85.8137109162083 58.5626692169133;86.3429215598831 57.3247646283263;86.8023347843292 56.4972627233695;87.4671547289276 55.2130384874339;88.1422377483772 53.8321052533843;88.9184133591001 52.0636701268315;89.3417818740399 50.42786763477;89.3417818740399 48.7478542645448;88.9536940686785 47.3773170414663;88.3186412962688 45.697303671241;87.7188692334374 44.2383446918349;86.7310093652445 42.8678074687564;85.5314652395818 41.8067463928246;84.0496754372925 40.8341070732206;82.2150785392201 39.4193589719782;79.6043060304247 38.0488217488997;76.7818492641593 36.8551280384765;73.8182696595808 35.9266995970363;71.4191814082553 35.5288016935619;69.161215995243 35.3519581809066;67.5735840642188 35.4845908153981;66.5504434864476 36.1035431096916;65.2450572320499 36.236175744183;63.4457410435558 36.1919648660192;62.3873197562063 35.5288016935619;60.7644071156038 34.5561623739578]);
BGTLeft_vol = impoly(gca,[60.905529953917 44.9899296206199;58.5064417025915 44.5920317171455;56.1426341608444 44.9015078642922;53.4613002328923 45.6530927930772;51.9044665388099 46.8307096974853;51.0225767750304 47.6802672196092;50.5186397671563 48.5298247417331;50.9210891432536 49.8089153404765;51.7325454635548 51.0468199290635;52.649843912591 51.8426157360123;54.3433179723502 52.8152550556164;55.4723006788563 53.5226291062376;56.6365640949408 54.8047445729884;57.6949853822903 55.7331730144287;58.5064417025915 56.7942340903604;59.3884594420495 57.8552951662922;59.6354244090977 59.0047779985516;60.3763193102423 59.3584650238621;61.2936177592785 59.4468867801898;62.1756354987364 59.1816215112069;63.128214657351 57.2363428719987;63.1987760765076 55.7331730144287;63.2693374956642 54.0089487660396;63.2340567860859 51.6215613451932;63.0576532381943 49.5878609496574;62.7754075615678 48.0404802139236;62.1050740795798 45.8741471838963]);
BGTRight_vol = impoly(gca,[73.394901144641 44.459399082654;71.4544621178336 44.5036099608178;69.8668301868094 44.5036099608178;68.4203210940984 44.8572969861284;68.2439175462068 46.4046777218622;68.2086368366285 48.3941672392342;67.5030226450622 49.8973370968042;67.150215549279 51.7984048578485;66.6915663247609 53.5668399844014;66.9385312918091 55.7331730144287;67.3266190971706 56.9710776030157;67.820549031267 58.3416148260942;68.5261632228334 59.137410633043;69.1964967048214 59.4910976583536;69.9726723155443 59.6237302928451;70.7488479262673 59.5795194146813;71.3133392795203 59.5795194146813;71.8778306327734 59.137410633043;72.1953570189783 58.4300365824219;72.5834448243397 57.4573972628178;73.2490043256748 57.1476161043109;74.1388791870224 55.7541362678117;75.2647787522918 54.3626357913502;76.6407264258461 52.9036768119441;77.522744165304 51.7984048578485;78.3342004856053 50.7373437819168;78.6870075813884 49.676282705985;79.1103760963282 49.0573304116915;79.3573410633765 48.1731128484151;78.5106040334969 46.9794191379919;77.2404984886775 45.8299363057325;76.0056736534364 45.1225622551113;74.9119716565086 44.6362425953093]);

cortex_vol = cortex_vol.createMask;
BGTLeft_vol = BGTLeft_vol.createMask;
BGTRight_vol = BGTRight_vol.createMask;

close;

% CRP original
figure(), imagesc(img_ori, [0 0.9e8]), shg, colormap(gray(256))

cortex_ori = impoly(gca, [58.9294716152156 36.4454160412187;56.8488842640768 36.4915290681164;54.4613250086715 37.2754505253763;52.7559255405249 37.5982417136598;51.3916059660076 38.7971804129985;49.5838825297722 39.6733279240537;47.7420511041739 40.8261535964948;46.1048676147532 41.8406401882429;44.5359001040583 43.4084831027628;43.6289467535373 44.8138914439665;42.9468959283692 46.4741699185662;42.728926236467 48.4286767951129;42.5109565445647 50.3831836716597;42.5109565445647 52.3376905482064;42.5109565445647 53.8323134538009;42.7963926465487 55.6284352306382;43.3080124869927 56.7812609030792;43.683200369985 58.1185386831109;44.1266042317031 59.271364355552;44.8175263862048 60.8174240032683;45.6289827065061 61.5690089320533;46.8285268321689 61.6132198102171;48.2044745057232 61.5690089320533;49.4745800505426 61.4805871757256;50.5682820474704 61.4363762975618;51.7678261731331 61.4805871757256;52.8968088796393 61.4805871757256;53.6024230712056 61.4363762975618;54.1707558369608 61.2060849218;53.5059358923625 60.7780101764881;52.1762960031658 60.6828824553077;51.1236644242184 60.1596799888154;49.5724178868223 59.826732964684;48.4089829837752 59.2084027770113;46.5807281361298 58.5425087287484;45.8605065294816 57.6863592381247;45.5584212873495 56.7500232121966;44.9939299340964 55.6447512581011;44.5705614191566 54.4952684258417;44.4294385808434 53.2573638372547;44.4294385808434 51.5331395888656;44.394157871265 49.941547974968;44.394157871265 48.7920651427086;44.9086231554894 47.5089088532086;45.4909238062204 46.1752647166214;46.3095155509308 44.6535348289992;47.2645392530928 43.4545961296604;48.8335067637877 42.2095444034241;50.4365822638455 41.3333968923689;51.9373337958146 40.5955884620066;53.8473812001388 39.3505367357702;55.8597525725517 38.8432934398962;57.1899641577061 38.1054850095339;58.9976875939415 38.2899371171244;60.8054110301769 38.1977110633292;62.8106882711461 38.5351414087018;63.6022661579373 39.3966497626679;64.284425945196 39.9500060854396;65.3076656260839 40.2727972737231;66.1270749715079 40.215154778927;66.6915663247609 39.3751480938144;67.5030226450622 38.5793522868656;68.8548965198289 38.0593719826362;70.6626199560643 38.1054850095339;72.5044513816626 37.9671459288409;73.9369869349058 38.2438240902268;75.4718464562377 38.3360501440221;77.5183258180137 39.5349888433608;79.1896172967973 40.4572493813137;80.4857208925887 41.2872838654712;81.7818244883802 42.3017704572194;82.9073881373569 43.7773873179439;83.9988437969708 45.2530041786685;85.0220834778587 46.2674907704167;85.7383512544803 47.4664294697554;86.386403052376 48.4348030346059;86.5193251077746 51.2236634417188;86.2017987215698 53.4784182280738;84.9740799366838 55.688677093336;83.7703349373645 56.902418908793;82.9806626744147 58.4311531633226;81.5275313950664 59.580863090703;79.7837738598485 60.0407470616552;78.9845516562069 60.7305730180834;78.475955708435 61.1904569890356;78.1126728885979 61.7653119527258;78.1126728885979 62.225195923678;78.6212688363698 62.6850798946301;78.9118950922395 63.0299928728443;79.5658041679462 63.3749058510584;80.3650263715878 63.3749058510584;81.6001879590338 63.3749058510584;82.7626929825125 63.3749058510584;83.6345717501215 63.1449638655823;84.2158242618608 62.225195923678;84.7244202096327 61.1904569890356;85.3783292853394 60.2706890471313;86.177551488981 59.465892097965;86.8314605646877 58.2012111778465;87.1201018003635 57.2466489594844;87.6219228201346 55.6594884255885;87.9564701666486 54.2486790621255;88.6813227507624 51.6915870908488;88.7370806418481 50.2807777273857;88.7370806418481 48.7817927787063;88.6478746638731 47.2789668677325;88.3186412962688 45.697303671241;87.7188692334374 44.2383446918349;86.7310093652445 42.8678074687564;85.5314652395818 41.8067463928246;84.0496754372925 40.8341070732206;82.2150785392201 39.4193589719782;79.6043060304247 38.0488217488997;76.7818492641593 36.8551280384765;73.8005549774541 36.3531899874234;71.5835356688635 36.3993030143211;69.5029483177246 36.4454160412187;67.6611168921263 36.4915290681164;66.5696612325124 36.537642095014;65.0348017111805 36.537642095014;63.6363741473003 36.4915290681164;62.3061625621459 36.537642095014;60.771303040814 36.4915290681164]);
BGTLeft_ori = impoly(gca, [60.905529953917 44.9899296206199;58.5064417025915 44.5920317171455;56.9709864541594 44.6881180429062;54.5830679442831 45.4143982165441;52.9911222710322 46.8669585638198;51.9780659335089 48.0082559795365;51.2544542638494 48.8382904636941;51.5438989317132 50.7058680530486;52.3398717683386 51.7434111582456;53.280566938896 52.6771999529228;54.2936232764193 53.9222516791592;55.3790407809085 55.2710577159153;56.4644582853977 56.4123551316319;57.2604311220232 57.1386353052698;58.0564039586486 58.1761784104668;58.7800156283081 58.7987042735849;59.6354244090977 59.0047779985516;60.3763193102423 59.3584650238621;61.2936177592785 59.4468867801898;62.3980739766056 58.5911956525455;63.128214657351 57.2363428719987;63.1987760765076 55.7331730144287;63.2693374956642 54.0089487660396;63.2340567860859 51.6215613451932;63.0576532381943 49.5878609496574;62.7754075615678 48.0404802139236;62.1050740795798 45.8741471838963]);
BGTRight_ori = impoly(gca, [73.107526687566 45.103135284985;71.660303348247 44.7918723534259;70.285441175894 44.8956266639456;69.4171071723026 45.4143982165441;68.6934955026431 46.7632042533001;68.2086368366285 48.3941672392342;67.5030226450622 49.8973370968042;67.150215549279 51.7984048578485;66.6915663247609 53.5668399844014;66.9385312918091 55.7331730144287;67.3266190971706 56.9710776030157;67.820549031267 58.3416148260942;68.5261632228334 59.137410633043;69.1964967048214 59.4910976583536;69.9726723155443 59.6237302928451;70.7488479262673 59.5795194146813;71.3133392795203 59.5795194146813;71.8778306327734 59.137410633043;73.179887854532 58.1761784104668;73.4693325223958 57.4498982368289;74.0482218581234 56.5161094421516;74.7718335277828 55.7898292685137;75.3507228635104 54.6485318527971;75.929612199238 53.299725816041;76.9426685367613 52.2621827108441;77.8110025403527 51.2246396056471;78.1728083751825 50.4983594320092;78.1004472082165 49.3570620162926;77.5939190394549 48.7345361531744;76.9426685367613 48.0082559795365;76.2190568671018 47.2819758058986;75.5678063644083 46.5556956322608;74.6994723608169 45.8294154586229]);

cortex_ori = cortex_ori.createMask;
BGTLeft_ori = BGTLeft_ori.createMask;
BGTRight_ori = BGTRight_ori.createMask;

close;

% Model-based correction
figure(), imagesc(MBCorrected, [0 1.5e8]), shg, colormap(gray(256))

cortex_MBcorr = impoly(gca, [58.9294716152156 36.4454160412187;56.8488842640768 36.4915290681164;54.4613250086715 37.2754505253763;52.7559255405249 37.5982417136598;51.3916059660076 38.7971804129985;49.5838825297722 39.6733279240537;47.7420511041739 40.8261535964948;46.1048676147532 41.8406401882429;44.5359001040583 43.4084831027628;43.6289467535373 44.8138914439665;42.9468959283692 46.4741699185662;42.728926236467 48.4286767951129;42.5109565445647 50.3831836716597;42.5109565445647 52.3376905482064;42.5109565445647 53.8323134538009;42.7963926465487 55.6284352306382;43.3080124869927 56.7812609030792;43.683200369985 58.1185386831109;44.1266042317031 59.271364355552;44.8175263862048 60.8174240032683;45.6289827065061 61.5690089320533;46.8285268321689 61.6132198102171;48.2044745057232 61.5690089320533;49.4745800505426 61.4805871757256;50.5682820474704 61.4363762975618;51.7678261731331 61.4805871757256;52.8968088796393 61.4805871757256;53.6024230712056 61.4363762975618;54.1707558369608 61.2060849218;53.5059358923625 60.7780101764881;52.1762960031658 60.6828824553077;51.1236644242184 60.1596799888154;49.5724178868223 59.826732964684;48.4089829837752 59.2084027770113;46.5807281361298 58.5425087287484;45.8605065294816 57.6863592381247;45.5584212873495 56.7500232121966;44.9939299340964 55.6447512581011;44.5705614191566 54.4952684258417;44.4294385808434 53.2573638372547;44.4294385808434 51.5331395888656;44.394157871265 49.941547974968;44.394157871265 48.7920651427086;44.9086231554894 47.5089088532086;45.4909238062204 46.1752647166214;46.3095155509308 44.6535348289992;47.2645392530928 43.4545961296604;48.8335067637877 42.2095444034241;50.4365822638455 41.3333968923689;51.9373337958146 40.5955884620066;53.8473812001388 39.3505367357702;55.8597525725517 38.8432934398962;57.1899641577061 38.1054850095339;58.9976875939415 38.2899371171244;60.8054110301769 38.1977110633292;62.8106882711461 38.5351414087018;63.6022661579373 39.3966497626679;64.284425945196 39.9500060854396;65.3076656260839 40.2727972737231;66.1270749715079 40.215154778927;66.6915663247609 39.3751480938144;67.5030226450622 38.5793522868656;68.8548965198289 38.0593719826362;70.6626199560643 38.1054850095339;72.5044513816626 37.9671459288409;73.9369869349058 38.2438240902268;75.4718464562377 38.3360501440221;77.5183258180137 39.5349888433608;79.1896172967973 40.4572493813137;80.4857208925887 41.2872838654712;81.7818244883802 42.3017704572194;82.9073881373569 43.7773873179439;83.9988437969708 45.2530041786685;85.0220834778587 46.2674907704167;85.7383512544803 47.4664294697554;86.386403052376 48.4348030346059;86.5193251077746 51.2236634417188;86.2017987215698 53.4784182280738;84.9740799366838 55.688677093336;83.7703349373645 56.902418908793;82.9806626744147 58.4311531633226;81.5275313950664 59.580863090703;79.7837738598485 60.0407470616552;78.9845516562069 60.7305730180834;78.475955708435 61.1904569890356;78.1126728885979 61.7653119527258;78.1126728885979 62.225195923678;78.6212688363698 62.6850798946301;78.9118950922395 63.0299928728443;79.5658041679462 63.3749058510584;80.3650263715878 63.3749058510584;81.6001879590338 63.3749058510584;82.7626929825125 63.3749058510584;83.6345717501215 63.1449638655823;84.2158242618608 62.225195923678;84.7244202096327 61.1904569890356;85.3783292853394 60.2706890471313;86.177551488981 59.465892097965;86.8314605646877 58.2012111778465;87.1201018003635 57.2466489594844;87.6219228201346 55.6594884255885;87.9564701666486 54.2486790621255;88.6813227507624 51.6915870908488;88.7370806418481 50.2807777273857;88.7370806418481 48.7817927787063;88.6478746638731 47.2789668677325;88.3186412962688 45.697303671241;87.7188692334374 44.2383446918349;86.7310093652445 42.8678074687564;85.5314652395818 41.8067463928246;84.0496754372925 40.8341070732206;82.2150785392201 39.4193589719782;79.6043060304247 38.0488217488997;76.7818492641593 36.8551280384765;73.8005549774541 36.3531899874234;71.5835356688635 36.3993030143211;69.5029483177246 36.4454160412187;67.6611168921263 36.4915290681164;66.5696612325124 36.537642095014;65.0348017111805 36.537642095014;63.6363741473003 36.4915290681164;62.3061625621459 36.537642095014;60.771303040814 36.4915290681164]);
BGTLeft_MBcorr = impoly(gca,[60.905529953917 44.9899296206199;58.5064417025915 44.5920317171455;56.9709864541594 44.6881180429062;54.5830679442831 45.4143982165441;52.9911222710322 46.8669585638198;51.9780659335089 48.0082559795365;51.2544542638494 48.8382904636941;51.5438989317132 50.7058680530486;52.3398717683386 51.7434111582456;53.280566938896 52.6771999529228;54.2936232764193 53.9222516791592;55.3790407809085 55.2710577159153;56.4644582853977 56.4123551316319;57.2604311220232 57.1386353052698;58.0564039586486 58.1761784104668;58.7800156283081 58.7987042735849;59.6354244090977 59.0047779985516;60.3763193102423 59.3584650238621;61.2936177592785 59.4468867801898;62.3980739766056 58.5911956525455;63.128214657351 57.2363428719987;63.1987760765076 55.7331730144287;63.2693374956642 54.0089487660396;63.2340567860859 51.6215613451932;63.0576532381943 49.5878609496574;62.7754075615678 48.0404802139236;62.1050740795798 45.8741471838963]);
BGTRight_MBcorr = impoly(gca,[73.107526687566 45.103135284985;71.660303348247 44.7918723534259;70.285441175894 44.8956266639456;69.4171071723026 45.4143982165441;68.6934955026431 46.7632042533001;68.2086368366285 48.3941672392342;67.5030226450622 49.8973370968042;67.150215549279 51.7984048578485;66.6915663247609 53.5668399844014;66.9385312918091 55.7331730144287;67.3266190971706 56.9710776030157;67.820549031267 58.3416148260942;68.5261632228334 59.137410633043;69.1964967048214 59.4910976583536;69.9726723155443 59.6237302928451;70.7488479262673 59.5795194146813;71.3133392795203 59.5795194146813;71.8778306327734 59.137410633043;73.179887854532 58.1761784104668;73.4693325223958 57.4498982368289;74.0482218581234 56.5161094421516;74.7718335277828 55.7898292685137;75.3507228635104 54.6485318527971;75.929612199238 53.299725816041;76.9426685367613 52.2621827108441;77.8110025403527 51.2246396056471;78.1728083751825 50.4983594320092;78.1004472082165 49.3570620162926;77.5939190394549 48.7345361531744;76.9426685367613 48.0082559795365;76.2190568671018 47.2819758058986;75.5678063644083 46.5556956322608;74.6994723608169 45.8294154586229]);

cortex_MBcorr = cortex_MBcorr.createMask;
BGTLeft_MBcorr = BGTLeft_MBcorr.createMask;
BGTRight_MBcorr = BGTRight_MBcorr.createMask;

close;

% Sensitivity correction
figure(), imagesc(sensCorrected, [0 3e8]), shg, colormap(gray(256))

cortex_sens = impoly(gca, [58.9294716152156 36.4454160412187;56.8488842640768 36.4915290681164;54.4613250086715 37.2754505253763;52.7559255405249 37.5982417136598;51.3916059660076 38.7971804129985;49.5838825297722 39.6733279240537;47.7420511041739 40.8261535964948;46.1048676147532 41.8406401882429;44.5359001040583 43.4084831027628;43.6289467535373 44.8138914439665;42.9468959283692 46.4741699185662;42.728926236467 48.4286767951129;42.5109565445647 50.3831836716597;42.5109565445647 52.3376905482064;42.5109565445647 53.8323134538009;42.7963926465487 55.6284352306382;43.3080124869927 56.7812609030792;43.683200369985 58.1185386831109;44.1266042317031 59.271364355552;44.8175263862048 60.8174240032683;45.6289827065061 61.5690089320533;46.8285268321689 61.6132198102171;48.2044745057232 61.5690089320533;49.4745800505426 61.4805871757256;50.5682820474704 61.4363762975618;51.7678261731331 61.4805871757256;52.8968088796393 61.4805871757256;53.6024230712056 61.4363762975618;54.1707558369608 61.2060849218;53.5059358923625 60.7780101764881;52.1762960031658 60.6828824553077;51.1236644242184 60.1596799888154;49.5724178868223 59.826732964684;48.4089829837752 59.2084027770113;46.5807281361298 58.5425087287484;45.8605065294816 57.6863592381247;45.5584212873495 56.7500232121966;44.9939299340964 55.6447512581011;44.5705614191566 54.4952684258417;44.4294385808434 53.2573638372547;44.4294385808434 51.5331395888656;44.394157871265 49.941547974968;44.394157871265 48.7920651427086;44.9086231554894 47.5089088532086;45.4909238062204 46.1752647166214;46.3095155509308 44.6535348289992;47.2645392530928 43.4545961296604;48.8335067637877 42.2095444034241;50.4365822638455 41.3333968923689;51.9373337958146 40.5955884620066;53.8473812001388 39.3505367357702;55.8597525725517 38.8432934398962;57.1899641577061 38.1054850095339;58.9976875939415 38.2899371171244;60.8054110301769 38.1977110633292;62.8106882711461 38.5351414087018;63.6022661579373 39.3966497626679;64.284425945196 39.9500060854396;65.3076656260839 40.2727972737231;66.1270749715079 40.215154778927;66.6915663247609 39.3751480938144;67.5030226450622 38.5793522868656;68.8548965198289 38.0593719826362;70.6626199560643 38.1054850095339;72.5044513816626 37.9671459288409;73.9369869349058 38.2438240902268;75.4718464562377 38.3360501440221;77.5183258180137 39.5349888433608;79.1896172967973 40.4572493813137;80.4857208925887 41.2872838654712;81.7818244883802 42.3017704572194;82.9073881373569 43.7773873179439;83.9988437969708 45.2530041786685;85.0220834778587 46.2674907704167;85.7383512544803 47.4664294697554;86.386403052376 48.4348030346059;86.5193251077746 51.2236634417188;86.2017987215698 53.4784182280738;84.9740799366838 55.688677093336;83.7703349373645 56.902418908793;82.9806626744147 58.4311531633226;81.5275313950664 59.580863090703;79.7837738598485 60.0407470616552;78.9845516562069 60.7305730180834;78.475955708435 61.1904569890356;78.1126728885979 61.7653119527258;78.1126728885979 62.225195923678;78.6212688363698 62.6850798946301;78.9118950922395 63.0299928728443;79.5658041679462 63.3749058510584;80.3650263715878 63.3749058510584;81.6001879590338 63.3749058510584;82.7626929825125 63.3749058510584;83.6345717501215 63.1449638655823;84.2158242618608 62.225195923678;84.7244202096327 61.1904569890356;85.3783292853394 60.2706890471313;86.177551488981 59.465892097965;86.8314605646877 58.2012111778465;87.1201018003635 57.2466489594844;87.6219228201346 55.6594884255885;87.9564701666486 54.2486790621255;88.6813227507624 51.6915870908488;88.7370806418481 50.2807777273857;88.7370806418481 48.7817927787063;88.6478746638731 47.2789668677325;88.3186412962688 45.697303671241;87.7188692334374 44.2383446918349;86.7310093652445 42.8678074687564;85.5314652395818 41.8067463928246;84.0496754372925 40.8341070732206;82.2150785392201 39.4193589719782;79.6043060304247 38.0488217488997;76.7818492641593 36.8551280384765;73.8005549774541 36.3531899874234;71.5835356688635 36.3993030143211;69.5029483177246 36.4454160412187;67.6611168921263 36.4915290681164;66.5696612325124 36.537642095014;65.0348017111805 36.537642095014;63.6363741473003 36.4915290681164;62.3061625621459 36.537642095014;60.771303040814 36.4915290681164]);
BGTLeft_sens = impoly(gca,[60.905529953917 44.9899296206199;58.5064417025915 44.5920317171455;56.9709864541594 44.6881180429062;54.5830679442831 45.4143982165441;52.9911222710322 46.8669585638198;51.9780659335089 48.0082559795365;51.2544542638494 48.8382904636941;51.5438989317132 50.7058680530486;52.3398717683386 51.7434111582456;53.280566938896 52.6771999529228;54.2936232764193 53.9222516791592;55.3790407809085 55.2710577159153;56.4644582853977 56.4123551316319;57.2604311220232 57.1386353052698;58.0564039586486 58.1761784104668;58.7800156283081 58.7987042735849;59.6354244090977 59.0047779985516;60.3763193102423 59.3584650238621;61.2936177592785 59.4468867801898;62.3980739766056 58.5911956525455;63.128214657351 57.2363428719987;63.1987760765076 55.7331730144287;63.2693374956642 54.0089487660396;63.2340567860859 51.6215613451932;63.0576532381943 49.5878609496574;62.7754075615678 48.0404802139236;62.1050740795798 45.8741471838963]);
BGTRight_sens = impoly(gca,[73.107526687566 45.103135284985;71.660303348247 44.7918723534259;70.285441175894 44.8956266639456;69.4171071723026 45.4143982165441;68.6934955026431 46.7632042533001;68.2086368366285 48.3941672392342;67.5030226450622 49.8973370968042;67.150215549279 51.7984048578485;66.6915663247609 53.5668399844014;66.9385312918091 55.7331730144287;67.3266190971706 56.9710776030157;67.820549031267 58.3416148260942;68.5261632228334 59.137410633043;69.1964967048214 59.4910976583536;69.9726723155443 59.6237302928451;70.7488479262673 59.5795194146813;71.3133392795203 59.5795194146813;71.8778306327734 59.137410633043;73.179887854532 58.1761784104668;73.4693325223958 57.4498982368289;74.0482218581234 56.5161094421516;74.7718335277828 55.7898292685137;75.3507228635104 54.6485318527971;75.929612199238 53.299725816041;76.9426685367613 52.2621827108441;77.8110025403527 51.2246396056471;78.1728083751825 50.4983594320092;78.1004472082165 49.3570620162926;77.5939190394549 48.7345361531744;76.9426685367613 48.0082559795365;76.2190568671018 47.2819758058986;75.5678063644083 46.5556956322608;74.6994723608169 45.8294154586229]);

cortex_sens = cortex_sens.createMask;
BGTLeft_sens = BGTLeft_sens.createMask;
BGTRight_sens = BGTRight_sens.createMask;

close;

% Hybrid correction
figure(), imagesc(hybCorrected, [0 2]), shg, colormap(gray(256))

cortex_hyb = impoly(gca, [58.9294716152156 36.4454160412187;56.8488842640768 36.4915290681164;54.4613250086715 37.2754505253763;52.7559255405249 37.5982417136598;51.3916059660076 38.7971804129985;49.5838825297722 39.6733279240537;47.7420511041739 40.8261535964948;46.1048676147532 41.8406401882429;44.5359001040583 43.4084831027628;43.6289467535373 44.8138914439665;42.9468959283692 46.4741699185662;42.728926236467 48.4286767951129;42.5109565445647 50.3831836716597;42.5109565445647 52.3376905482064;42.5109565445647 53.8323134538009;42.7963926465487 55.6284352306382;43.3080124869927 56.7812609030792;43.683200369985 58.1185386831109;44.1266042317031 59.271364355552;44.8175263862048 60.8174240032683;45.6289827065061 61.5690089320533;46.8285268321689 61.6132198102171;48.2044745057232 61.5690089320533;49.4745800505426 61.4805871757256;50.5682820474704 61.4363762975618;51.7678261731331 61.4805871757256;52.8968088796393 61.4805871757256;53.6024230712056 61.4363762975618;54.1707558369608 61.2060849218;53.5059358923625 60.7780101764881;52.1762960031658 60.6828824553077;51.1236644242184 60.1596799888154;49.5724178868223 59.826732964684;48.4089829837752 59.2084027770113;46.5807281361298 58.5425087287484;45.8605065294816 57.6863592381247;45.5584212873495 56.7500232121966;44.9939299340964 55.6447512581011;44.5705614191566 54.4952684258417;44.4294385808434 53.2573638372547;44.4294385808434 51.5331395888656;44.394157871265 49.941547974968;44.394157871265 48.7920651427086;44.9086231554894 47.5089088532086;45.4909238062204 46.1752647166214;46.3095155509308 44.6535348289992;47.2645392530928 43.4545961296604;48.8335067637877 42.2095444034241;50.4365822638455 41.3333968923689;51.9373337958146 40.5955884620066;53.8473812001388 39.3505367357702;55.8597525725517 38.8432934398962;57.1899641577061 38.1054850095339;58.9976875939415 38.2899371171244;60.8054110301769 38.1977110633292;62.8106882711461 38.5351414087018;63.6022661579373 39.3966497626679;64.284425945196 39.9500060854396;65.3076656260839 40.2727972737231;66.1270749715079 40.215154778927;66.6915663247609 39.3751480938144;67.5030226450622 38.5793522868656;68.8548965198289 38.0593719826362;70.6626199560643 38.1054850095339;72.5044513816626 37.9671459288409;73.9369869349058 38.2438240902268;75.4718464562377 38.3360501440221;77.5183258180137 39.5349888433608;79.1896172967973 40.4572493813137;80.4857208925887 41.2872838654712;81.7818244883802 42.3017704572194;82.9073881373569 43.7773873179439;83.9988437969708 45.2530041786685;85.0220834778587 46.2674907704167;85.7383512544803 47.4664294697554;86.386403052376 48.4348030346059;86.5193251077746 51.2236634417188;86.2017987215698 53.4784182280738;84.9740799366838 55.688677093336;83.7703349373645 56.902418908793;82.9806626744147 58.4311531633226;81.5275313950664 59.580863090703;79.7837738598485 60.0407470616552;78.9845516562069 60.7305730180834;78.475955708435 61.1904569890356;78.1126728885979 61.7653119527258;78.1126728885979 62.225195923678;78.6212688363698 62.6850798946301;78.9118950922395 63.0299928728443;79.5658041679462 63.3749058510584;80.3650263715878 63.3749058510584;81.6001879590338 63.3749058510584;82.7626929825125 63.3749058510584;83.6345717501215 63.1449638655823;84.2158242618608 62.225195923678;84.7244202096327 61.1904569890356;85.3783292853394 60.2706890471313;86.177551488981 59.465892097965;86.8314605646877 58.2012111778465;87.1201018003635 57.2466489594844;87.6219228201346 55.6594884255885;87.9564701666486 54.2486790621255;88.6813227507624 51.6915870908488;88.7370806418481 50.2807777273857;88.7370806418481 48.7817927787063;88.6478746638731 47.2789668677325;88.3186412962688 45.697303671241;87.7188692334374 44.2383446918349;86.7310093652445 42.8678074687564;85.5314652395818 41.8067463928246;84.0496754372925 40.8341070732206;82.2150785392201 39.4193589719782;79.6043060304247 38.0488217488997;76.7818492641593 36.8551280384765;73.8005549774541 36.3531899874234;71.5835356688635 36.3993030143211;69.5029483177246 36.4454160412187;67.6611168921263 36.4915290681164;66.5696612325124 36.537642095014;65.0348017111805 36.537642095014;63.6363741473003 36.4915290681164;62.3061625621459 36.537642095014;60.771303040814 36.4915290681164]);
BGTLeft_hyb = impoly(gca,[60.905529953917 44.9899296206199;58.5064417025915 44.5920317171455;56.9709864541594 44.6881180429062;54.5830679442831 45.4143982165441;52.9911222710322 46.8669585638198;51.9780659335089 48.0082559795365;51.2544542638494 48.8382904636941;51.5438989317132 50.7058680530486;52.3398717683386 51.7434111582456;53.280566938896 52.6771999529228;54.2936232764193 53.9222516791592;55.3790407809085 55.2710577159153;56.4644582853977 56.4123551316319;57.2604311220232 57.1386353052698;58.0564039586486 58.1761784104668;58.7800156283081 58.7987042735849;59.6354244090977 59.0047779985516;60.3763193102423 59.3584650238621;61.2936177592785 59.4468867801898;62.3980739766056 58.5911956525455;63.128214657351 57.2363428719987;63.1987760765076 55.7331730144287;63.2693374956642 54.0089487660396;63.2340567860859 51.6215613451932;63.0576532381943 49.5878609496574;62.7754075615678 48.0404802139236;62.1050740795798 45.8741471838963]);
BGTRight_hyb = impoly(gca,[73.107526687566 45.103135284985;71.660303348247 44.7918723534259;70.285441175894 44.8956266639456;69.4171071723026 45.4143982165441;68.6934955026431 46.7632042533001;68.2086368366285 48.3941672392342;67.5030226450622 49.8973370968042;67.150215549279 51.7984048578485;66.6915663247609 53.5668399844014;66.9385312918091 55.7331730144287;67.3266190971706 56.9710776030157;67.820549031267 58.3416148260942;68.5261632228334 59.137410633043;69.1964967048214 59.4910976583536;69.9726723155443 59.6237302928451;70.7488479262673 59.5795194146813;71.3133392795203 59.5795194146813;71.8778306327734 59.137410633043;73.179887854532 58.1761784104668;73.4693325223958 57.4498982368289;74.0482218581234 56.5161094421516;74.7718335277828 55.7898292685137;75.3507228635104 54.6485318527971;75.929612199238 53.299725816041;76.9426685367613 52.2621827108441;77.8110025403527 51.2246396056471;78.1728083751825 50.4983594320092;78.1004472082165 49.3570620162926;77.5939190394549 48.7345361531744;76.9426685367613 48.0082559795365;76.2190568671018 47.2819758058986;75.5678063644083 46.5556956322608;74.6994723608169 45.8294154586229]);

cortex_hyb = cortex_hyb.createMask;
BGTLeft_hyb = BGTLeft_hyb.createMask;
BGTRight_hyb = BGTRight_hyb.createMask;

close;


%% Definir ROIs en imágenes

c1_MBcorr = MBCorrected .* cortex_MBcorr;
c2_MBcorr = MBCorrected .* BGTLeft_MBcorr;
c3_MBcorr = MBCorrected .* BGTRight_MBcorr;

c1_hyb = hybCorrected .* cortex_hyb;
c2_hyb = hybCorrected .* BGTLeft_hyb;
c3_hyb = hybCorrected .* BGTRight_hyb;

c1_sens = sensCorrected .* cortex_sens;
c2_sens = sensCorrected .* BGTLeft_sens;
c3_sens = sensCorrected .* BGTRight_sens;

c1_ori = img_ori .* cortex_ori;
c2_ori = img_ori .* BGTLeft_ori;
c3_ori = img_ori .* BGTRight_ori;

c1_vol = img_vol .* cortex_vol;
c2_vol = img_vol .* BGTLeft_vol;
c3_vol = img_vol .* BGTRight_vol;

clear cortex_vol cortex_ori cortex_MBcorr cortex_hyb cortex_sens
clear BGTLeft_vol BGTLeft_ori BGTLeft_MBcorr BGTLeft_hyb BGTLeft_sens
clear BGTRight_vol BGTRight_ori BGTRight_MBcorr BGTRight_hyb BGTRight_sens


%% Calculations

c1_vol(c1_vol==0) = NaN; c2_vol(c2_vol==0) = NaN; c3_vol(c3_vol==0) = NaN; 
c1_ori(c1_ori==0) = NaN; c2_ori(c2_ori==0) = NaN; c3_ori(c3_ori==0) = NaN; 
c1_MBcorr(c1_MBcorr==0) = NaN; c2_MBcorr(c2_MBcorr==0) = NaN; c3_MBcorr(c3_MBcorr==0) = NaN; 
c1_sens(c1_sens==0) = NaN; c2_sens(c2_sens==0) = NaN; c3_sens(c3_sens==0) = NaN; 
c1_hyb(c1_hyb==0) = NaN; c2_hyb(c2_hyb==0) = NaN; c3_hyb(c3_hyb==0) = NaN; 
 
% Smax, Smin
Smax_c1_vol = max(c1_vol(:)); Smin_c1_vol = min(c1_vol(:));
Smax_c2_vol = max(c2_vol(:)); Smin_c2_vol = min(c2_vol(:));
Smax_c3_vol = max(c3_vol(:)); Smin_c3_vol = min(c3_vol(:));

Smax_c1_ori = max(c1_ori(:)); Smin_c1_ori = min(c1_ori(:));
Smax_c2_ori = max(c2_ori(:)); Smin_c2_ori = min(c2_ori(:));
Smax_c3_ori = max(c3_ori(:)); Smin_c3_ori = min(c3_ori(:));

Smax_c1_MBcorr = max(c1_MBcorr(:)); Smin_c1_MBcorr = min(c1_MBcorr(:));
Smax_c2_MBcorr = max(c2_MBcorr(:)); Smin_c2_MBcorr = min(c2_MBcorr(:));
Smax_c3_MBcorr = max(c3_MBcorr(:)); Smin_c3_MBcorr = min(c3_MBcorr(:));

Smax_c1_sens = max(c1_sens(:)); Smin_c1_sens = min(c1_sens(:));
Smax_c2_sens = max(c2_sens(:)); Smin_c2_sens = min(c2_sens(:));
Smax_c3_sens = max(c3_sens(:)); Smin_c3_sens = min(c3_sens(:));

Smax_c1_hyb = max(c1_hyb(:)); Smin_c1_hyb = min(c1_hyb(:));
Smax_c2_hyb = max(c2_hyb(:)); Smin_c2_hyb = min(c2_hyb(:));
Smax_c3_hyb = max(c3_hyb(:)); Smin_c3_hyb = min(c3_hyb(:));

clear c1_vol c2_vol c3_vol 
clear c1_ori c2_ori c3_ori 
clear c1_MBcorr c2_MBcorr c3_MBcorr 
clear c1_sens c2_sens c3_sens 
clear c1_hyb c2_hyb c3_hyb 
clear img_ori img_vol hybCorrected sensCorrected MBCorrected


%% Integral non-uniformity or percent image uniformity (PIU)

PIU_vol = zeros(3,1);
PIU_ori = zeros(3,1);
PIU_MBcorr = zeros(3,1);
PIU_sens = zeros(3,1);
PIU_hyb = zeros(3,1);

delta_c1_vol = Smax_c1_vol - Smin_c1_vol; mid_c1_vol = Smax_c1_vol + Smin_c1_vol;
delta_c2_vol = Smax_c2_vol - Smin_c2_vol; mid_c2_vol = Smax_c2_vol + Smin_c2_vol;
delta_c3_vol = Smax_c3_vol - Smin_c3_vol; mid_c3_vol = Smax_c3_vol + Smin_c3_vol;

PIU_vol(1,:) = (1- delta_c1_vol/mid_c1_vol) * 100;
PIU_vol(2,:) = (1- delta_c2_vol/mid_c2_vol) * 100;
PIU_vol(3,:) = (1- delta_c3_vol/mid_c3_vol) * 100;
clear delta_c1_vol delta_c2_vol delta_c3_vol 
clear mid_c1_vol mid_c2_vol mid_c3_vol 
clear Smax_c1_vol Smax_c2_vol Smax_c3_vol 
clear Smin_c1_vol Smin_c2_vol Smin_c3_vol 

delta_c1_ori = Smax_c1_ori - Smin_c1_ori; mid_c1_ori = Smax_c1_ori + Smin_c1_ori;
delta_c2_ori = Smax_c2_ori - Smin_c2_ori; mid_c2_ori = Smax_c2_ori + Smin_c2_ori;
delta_c3_ori = Smax_c3_ori - Smin_c3_ori; mid_c3_ori = Smax_c3_ori + Smin_c3_ori;

PIU_ori(1,:) = (1- delta_c1_ori/mid_c1_ori) * 100;
PIU_ori(2,:) = (1- delta_c2_ori/mid_c2_ori) * 100;
PIU_ori(3,:) = (1- delta_c3_ori/mid_c3_ori) * 100;
clear delta_c1_ori delta_c2_ori delta_c3_ori 
clear mid_c1_ori mid_c2_ori mid_c3_ori 
clear Smax_c1_ori Smax_c2_ori Smax_c3_ori 
clear Smin_c1_ori Smin_c2_ori Smin_c3_ori 

delta_c1_MBcorr = Smax_c1_MBcorr - Smin_c1_MBcorr; mid_c1_MBcorr = Smax_c1_MBcorr + Smin_c1_MBcorr;
delta_c2_MBcorr = Smax_c2_MBcorr - Smin_c2_MBcorr; mid_c2_MBcorr = Smax_c2_MBcorr + Smin_c2_MBcorr;
delta_c3_MBcorr = Smax_c3_MBcorr - Smin_c3_MBcorr; mid_c3_MBcorr = Smax_c3_MBcorr + Smin_c3_MBcorr;

PIU_MBcorr(1,:) = (1- delta_c1_MBcorr/mid_c1_MBcorr) * 100;
PIU_MBcorr(2,:) = (1- delta_c2_MBcorr/mid_c2_MBcorr) * 100;
PIU_MBcorr(3,:) = (1- delta_c3_MBcorr/mid_c3_MBcorr) * 100;
clear delta_c1_MBcorr delta_c2_MBcorr delta_c3_MBcorr 
clear mid_c1_MBcorr mid_c2_MBcorr mid_c3_MBcorr 
clear Smax_c1_MBcorr Smax_c2_MBcorr Smax_c3_MBcorr 
clear Smin_c1_MBcorr Smin_c2_MBcorr Smin_c3_MBcorr 

delta_c1_sens = Smax_c1_sens - Smin_c1_sens; mid_c1_sens = Smax_c1_sens + Smin_c1_sens;
delta_c2_sens = Smax_c2_sens - Smin_c2_sens; mid_c2_sens = Smax_c2_sens + Smin_c2_sens;
delta_c3_sens = Smax_c3_sens - Smin_c3_sens; mid_c3_sens = Smax_c3_sens + Smin_c3_sens;

PIU_sens(1,:) = (1- delta_c1_sens/mid_c1_sens) * 100;
PIU_sens(2,:) = (1- delta_c2_sens/mid_c2_sens) * 100;
PIU_sens(3,:) = (1- delta_c3_sens/mid_c3_sens) * 100;
clear delta_c1_sens delta_c2_sens delta_c3_sens 
clear mid_c1_sens mid_c2_sens mid_c3_sens 
clear Smax_c1_sens Smax_c2_sens Smax_c3_sens
clear Smin_c1_sens Smin_c2_sens Smin_c3_sens 

delta_c1_hyb = Smax_c1_hyb - Smin_c1_hyb; mid_c1_hyb = Smax_c1_hyb + Smin_c1_hyb;
delta_c2_hyb = Smax_c2_hyb - Smin_c2_hyb; mid_c2_hyb = Smax_c2_hyb + Smin_c2_hyb;
delta_c3_hyb = Smax_c3_hyb - Smin_c3_hyb; mid_c3_hyb = Smax_c3_hyb + Smin_c3_hyb;

PIU_hyb(1,:) = (1- delta_c1_hyb/mid_c1_hyb) * 100;
PIU_hyb(2,:) = (1- delta_c2_hyb/mid_c2_hyb) * 100;
PIU_hyb(3,:) = (1- delta_c3_hyb/mid_c3_hyb) * 100;
clear delta_c1_hyb delta_c2_hyb delta_c3_hyb 
clear mid_c1_hyb mid_c2_hyb mid_c3_hyb 
clear Smax_c1_hyb Smax_c2_hyb Smax_c3_hyb 
clear Smin_c1_hyb Smin_c2_hyb Smin_c3_hyb 

PIU_all = cat(2,PIU_vol,PIU_ori,PIU_MBcorr,PIU_sens,PIU_hyb);
clear PIU_vol PIU_ori PIU_MBcorr PIU_hyb PIU_sens

save(fullfile(pathOUT,'PIU_values_inVivo.mat'), 'PIU_all');


%% Important stuff for plot

cmap = [0 0 170; 255 128 0; 255 0 127; 0 153 76; 255 255 0; 102 0 102; 146 226 55; 51 51 255; 153 0 0; 64 64 64; 0 102 0; 0 153 153];
cmap = cmap ./ 256;


%% Plot

roi_labels = {'Cortex'; 'BGT (left)'; 'BGT (right)'};

hF = figure(); 
plot(PIU_all(:,4),1:3, 'LineWidth', 3, 'MarkerSize',25,'Marker','.', 'Color',cmap(1,:)), axis ij,hold on, %easy
plot(PIU_all(:,3),1:3, 'LineWidth', 3, 'MarkerSize',25,'Marker','.', 'Color',cmap(6,:)),axis ij,           %MB  
plot(PIU_all(:,5),1:3, 'LineWidth', 3, 'MarkerSize',25,'Marker','.', 'Color',cmap(8,:)),axis ij,          %hybrid
plot(PIU_all(:,2),1:3, 'LineWidth', 3, 'MarkerSize',25,'Marker','.', 'Color',cmap(9,:)),axis ij,          %ori
plot(PIU_all(:,1),1:3, 'LineWidth', 3, 'MarkerSize',25,'Marker','.', 'Color',cmap(4,:)),axis ij, hold off %vol

xlim([0 105])
ax = gca; 
ax.YAxis.TickValues = 1:1:3;
ax.YAxis.TickLabel = roi_labels;
ax.XAxis.TickValues = [0,35,70,100];
set(gca, 'FontSize', 14)
grid on; 
set(gcf,'units','normalized','outerposition',[0 0 0.25 1]);
saveas(hF, fullfile(pathOUT, 'PIU_plot_inVivo.png'));

